---
title: "Stripe Integration"
description: "Add payment processing capabilities to your superun app using Stripe"
image: "https://b.ux-cdn.com/uxarts/files/t20251201143554/mm27xz4u.png"
---

## Overview

Stripe is a payment processing platform that allows you to accept payments online. With superun's Stripe integration, you can easily add payment functionality to your applications, including one-time payments, subscriptions, and marketplace features.

superun now lets you set up Stripe entirely through **chat**.

**Chat‑driven auto‑setup (recommended)**  
After you connect **superun Cloud** (or Supabase) and configure your Stripe credentials via **Build → Services → Stripe**, just describe what you need:

* "Add three subscription tiers: Basic at $9/month, Pro at $29/month, and Enterprise at $99/month"
* "Create a one‑time checkout for my e‑book at $29"
* "Set up a payment form for my product page"

superun generates the checkout components, database tables, and payment logic—no manual coding or webhooks unless you ask for them.

<Note>
  - For **one‑off sales**, be sure your cart or product page already works.
  - For **subscriptions**, confirm superun Cloud (or Supabase) Auth is in place so superun can link Stripe customers to each user's **id**
</Note>

### Key takeaways

* Use the **chat‑driven flow** for both subscriptions and one‑off payments.
* **Never paste your Stripe Secret Key in chat.** Configure it via **Build → Services → Stripe**, using the **STRIPE_API_KEY** field.
* **Webhooks are opt‑in.** If you use webhooks, paste your Stripe webhook signing secret into the **STRIPE_WEBHOOK_SECRET** field so superun can verify incoming events.
* Debug in **Browser Console → Network/Errors**, **superun Cloud → Logs**, and **Stripe Dashboard → Logs**.
* Always test in **Stripe Test Mode**, then deploy.

## What is Stripe

Stripe provides a comprehensive suite of payment APIs and tools:

- **Payment Processing:** Accept credit cards, digital wallets, and local payment methods
- **Subscriptions:** Recurring billing and subscription management
- **Marketplace:** Multi-party payments and marketplace functionality
- **Connect:** Platform payments for marketplaces and platforms
- **Billing:** Invoicing and billing management
- **Tax:** Automatic tax calculation and compliance

## Key Benefits

- **Global Reach:** Accept payments from customers worldwide
- **Multiple Payment Methods:** Credit cards, digital wallets, bank transfers, and more
- **Developer-Friendly:** Well-documented APIs and excellent developer experience
- **Compliance:** PCI DSS compliant, handles sensitive payment data securely
- **Real-time:** Instant payment processing and webhook notifications

## Requirements

Before integrating Stripe, ensure the following prerequisites are met:

* The project **must** be connected to **superun Cloud** (or Supabase). [Learn more about superun Cloud](/en/superun/integrations/cloud) or [Supabase integration](/en/superun/integrations/supabase)
* A **Stripe account** with properly configured products (for subscriptions)
* A working **frontend**:
  * For individual product sales, ensure a shopping cart and checkout page are functional.
  * For subscriptions, set up login functionalities and different pricing tiers.

<Note>
  **Please note**
  Stripe integration doesn't work in preview. To test the integration, make sure to **deploy** your project. You should also make sure to be in **test mode** in Stripe when trying out the functionality. When testing payment, use test card number: `4242 4242 4242 4242`, any 3 digits as CVC, and any future date.
</Note>

## Stripe payment setup (No‑code chat flow)

superun now generates all Stripe logic for you. Once your **STRIPE_API_KEY** (and optional **STRIPE_WEBHOOK_SECRET**) are configured via **Build → Services → Stripe** and your project is **connected to superun Cloud** (or Supabase), simply tell superun what you need in chat—no manual coding required.

<Steps>
  <Step title="Step 1: Prep your project">
    * **superun Cloud** (or Supabase) connected
    * **Stripe Secret Key** added via **Build** tab → **Service** section → **Stripe** → **Enable**
    * (Optional) Prices or product IDs handy from Stripe Dashboard
  </Step>

  <Step title="Step 2: Describe your payment needs in chat">
    Examples:

    * "Create a one-time checkout for my 'Digital Course' at $29"
    * "Set up an annual Premium plan for $99, tied to each user's id"
    * "Add three subscription tiers: Basic at $9/month, Pro at $29/month, and Enterprise at $99/month"
    * "Create a payment form for my product page"
  </Step>

  <Step title="Step 3: Review & apply">
    superun auto‑scaffolds the payment components, database tables (if using superun Cloud), and UI elements (all tied to the user's id). Check the preview, then click **Apply** to deploy.
  </Step>
</Steps>

<Note>
  * Subscriptions should always be linked to the authenticated user's `id` in superun Cloud (or Supabase) for secure, role‑based access.
</Note>

## Getting Started

### 1. Create a Stripe Account

1. Go to [stripe.com](https://stripe.com) and sign up
2. Complete the account setup process
3. Verify your business information
4. Activate your account (test mode is available immediately)

### 2. Get Your API Keys

In your Stripe dashboard:

1. Go to **Developers → API Keys**
2. Copy your **Publishable Key** (starts with `pk_test_` or `pk_live_`)
3. Copy your **Secret Key** (starts with `sk_test_` or `sk_live_`)
4. Keep your secret key secure and never expose it in client-side code

<Warning>
  **Important Security Warning**

  Never paste your **Secret Key** directly in superun chat. Treat it like the keys to your house—exposing it could allow unauthorized access to your Stripe account. Instead, store it securely using the **Build** tab → **Service** section → **Stripe** → **Enable** feature.
</Warning>

### 3. Configure Stripe in superun

You can enable Stripe integration in two ways:

#### Option 1: Enable via Build Service (Recommended)

1. In your superun project, go to the **Build** tab.
2. Open **Services** and select **Stripe**.
3. In the **STRIPE_API_KEY** field, paste your **Stripe Secret Key** (starts with `sk_test_` or `sk_live_`).
4. (Optional) In the **STRIPE_WEBHOOK_SECRET** field, paste your **Webhook signing secret** (starts with `whsec_...`) if you plan to use webhooks.
5. Click **Save Changes** and wait for the Stripe integration to finish enabling.

superun will automatically configure your project to use Stripe with these credentials.

#### Option 2: Enable via Chat

You can also enable Stripe by asking superun in the chat:

```
Enable Stripe payment processing for my project
```

or

```
Add Stripe integration with test keys
```

superun will guide you through the setup process and automatically configure the integration. When prompted, use the **Build** tab → **Service** section to securely add your API keys.

## Manual Payment Setup (Advanced)

<Note>
  **Recommended:** Use the **chat-driven flow** described above for the easiest setup. The following sections are for advanced users who want to implement payments manually or customize the generated code.
</Note>

### Install Stripe SDK

superun automatically includes the Stripe SDK when you enable Stripe integration, but you can also install it manually:

```bash
npm install @stripe/stripe-js
```

### Initialize Stripe

```jsx
import { loadStripe } from '@stripe/stripe-js';

// Initialize Stripe
const stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY);
```

## One-Time Payments

### Creating a Payment Intent

```jsx
// Server-side: Create payment intent
const createPaymentIntent = async (amount, currency = 'usd') => {
  const response = await fetch('/api/create-payment-intent', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      amount: amount * 100, // Amount in cents
      currency,
    }),
  });

  const { clientSecret } = await response.json();
  return clientSecret;
};
```

### Processing Payment

```jsx
import { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';

const CheckoutForm = () => {
  const stripe = useStripe();
  const elements = useElements();
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (event) => {
    event.preventDefault();

    if (!stripe || !elements) {
      return;
    }

    setLoading(true);

    // Create payment intent
    const clientSecret = await createPaymentIntent(50); // $50.00

    // Confirm payment
    const { error, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {
      payment_method: {
        card: elements.getElement(CardElement),
      },
    });

    if (error) {
      console.error('Payment failed:', error);
    } else if (paymentIntent.status === 'succeeded') {
      console.log('Payment succeeded:', paymentIntent);
      // Handle successful payment
    }

    setLoading(false);
  };

  return (
    <form onSubmit={handleSubmit}>
      <CardElement
        options={{
          style: {
            base: {
              fontSize: '16px',
              color: '#424770',
              '::placeholder': {
                color: '#aab7c4',
              },
            },
          },
        }}
      />
      <button disabled={!stripe || loading}>
        {loading ? 'Processing...' : 'Pay $50.00'}
      </button>
    </form>
  );
};

// Wrap your app with Elements
const App = () => {
  return (
    <Elements stripe={stripePromise}>
      <CheckoutForm />
    </Elements>
  );
};
```

## Subscriptions

### Creating a Subscription

```jsx
// Create a subscription
const createSubscription = async (priceId, customerId) => {
  const response = await fetch('/api/create-subscription', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      priceId,
      customerId,
    }),
  });

  const { subscription } = await response.json();
  return subscription;
};
```

### Subscription Management

```jsx
// Cancel a subscription
const cancelSubscription = async (subscriptionId) => {
  const response = await fetch('/api/cancel-subscription', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      subscriptionId,
    }),
  });

  const { subscription } = await response.json();
  return subscription;
};

// Update subscription
const updateSubscription = async (subscriptionId, newPriceId) => {
  const response = await fetch('/api/update-subscription', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      subscriptionId,
      newPriceId,
    }),
  });

  const { subscription } = await response.json();
  return subscription;
};
```

## Customer Management

### Creating Customers

```jsx
// Create a customer
const createCustomer = async (email, name) => {
  const response = await fetch('/api/create-customer', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      email,
      name,
    }),
  });

  const { customer } = await response.json();
  return customer;
};
```

### Customer Portal

```jsx
// Create customer portal session
const createPortalSession = async (customerId) => {
  const response = await fetch('/api/create-portal-session', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      customerId,
    }),
  });

  const { url } = await response.json();
  return url;
};

// Redirect to customer portal
const handleManageSubscription = async () => {
  const url = await createPortalSession(customerId);
  window.location.href = url;
};
```

## Advanced integration: Webhooks & superun Cloud

For complex payment structures such as **subscriptions and role-based access**, superun recommends using **superun Cloud** (or Supabase) to securely handle Stripe integration. This allows for proper webhook handling, subscription management, and role-based access control based on payment tiers.

<Note>
  Webhooks are **optional** for basic payment flows. superun can handle payments without webhooks, but setting them up enables real-time updates and better subscription management.
</Note>

### Setting Up Webhooks

<Steps>
  <Step title="Step 1: Connect superun Cloud">
    Getting started is simple. superun makes connecting superun Cloud effortless:

    1. Go to **Build** tab → **Service** section
    2. Find **superun Cloud** and click **Enable**
    3. Follow the instructions to set up your cloud project
    4. Once connected, superun Cloud enables secure payment processing, subscription management, webhook handling, customer data storage, and error handling.
  </Step>

  <Step title="Step 2: Retrieve the Webhook Endpoint URL">
    After superun generates the webhook handler, retrieve the endpoint URL from:
    * **superun Cloud** → **Functions** → Your webhook function
    * Or ask superun in chat: "What's my Stripe webhook endpoint URL?"
  </Step>

  <Step title="Step 3: Configure Webhook in Stripe Dashboard">
    1. Go to **Stripe Dashboard** → **Developers** → **Webhooks** → **Add endpoint**
    2. Enter your webhook URL from Step 2
    3. Select the events you want to listen for:
      * `payment_intent.succeeded`
      * `payment_intent.payment_failed`
      * `customer.subscription.created`
      * `customer.subscription.updated`
      * `customer.subscription.deleted`
    4. Copy the **Webhook Signing Secret** (starts with `whsec_`)
  </Step>

  <Step title="Step 4: Store Webhook Secret Securely">
    Store the webhook signing secret in your superun Cloud environment variables or ask superun in chat to help you configure it securely.

    <Info>
      If unsure about naming the secret, ask superun in **Ask** mode for guidance.
    </Info>
  </Step>
</Steps>

### Processing Webhooks

```jsx
// webhook handler
import Stripe from 'stripe';

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY);

export default async function handler(req, res) {
  if (req.method !== 'POST') {
    return res.status(405).end();
  }

  const sig = req.headers['stripe-signature'];
  const endpointSecret = process.env.STRIPE_WEBHOOK_SECRET;

  let event;

  try {
    event = stripe.webhooks.constructEvent(req.body, sig, endpointSecret);
  } catch (err) {
    console.error('Webhook signature verification failed:', err.message);
    return res.status(400).send(`Webhook Error: ${err.message}`);
  }

  // Handle the event
  switch (event.type) {
    case 'payment_intent.succeeded':
      const paymentIntent = event.data.object;
      console.log('Payment succeeded:', paymentIntent.id);
      // Update your database, send confirmation email, etc.
      break;

    case 'customer.subscription.created':
      const subscription = event.data.object;
      console.log('Subscription created:', subscription.id);
      // Activate user's premium features
      break;

    case 'customer.subscription.updated':
      const updatedSubscription = event.data.object;
      console.log('Subscription updated:', updatedSubscription.id);
      // Update subscription status
      break;

    case 'customer.subscription.deleted':
      const deletedSubscription = event.data.object;
      console.log('Subscription cancelled:', deletedSubscription.id);
      // Deactivate user's premium features
      break;

    default:
      console.log(`Unhandled event type ${event.type}`);
  }

  res.json({ received: true });
}
```

## Advanced Features

### Payment Methods

```jsx
// Save payment method for future use
const savePaymentMethod = async (customerId, paymentMethodId) => {
  const response = await fetch('/api/save-payment-method', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      customerId,
      paymentMethodId,
    }),
  });

  const { paymentMethod } = await response.json();
  return paymentMethod;
};

// List customer's payment methods
const getPaymentMethods = async (customerId) => {
  const response = await fetch(`/api/payment-methods/${customerId}`);
  const { paymentMethods } = await response.json();
  return paymentMethods;
};
```

### Invoicing

```jsx
// Create an invoice
const createInvoice = async (customerId, items) => {
  const response = await fetch('/api/create-invoice', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      customerId,
      items,
    }),
  });

  const { invoice } = await response.json();
  return invoice;
};

// Send invoice to customer
const sendInvoice = async (invoiceId) => {
  const response = await fetch('/api/send-invoice', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      invoiceId,
    }),
  });

  const { invoice } = await response.json();
  return invoice;
};
```

### Marketplace Payments

```jsx
// Create a connected account
const createConnectedAccount = async (email, country) => {
  const response = await fetch('/api/create-connected-account', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      email,
      country,
    }),
  });

  const { account } = await response.json();
  return account;
};

// Create account link for onboarding
const createAccountLink = async (accountId) => {
  const response = await fetch('/api/create-account-link', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      accountId,
    }),
  });

  const { url } = await response.json();
  return url;
};
```

## Testing Your Integration

### Test Mode Setup

* **Use Stripe's Test Mode** to safely test payments before going live
* **Switch to Test Mode** in Stripe Dashboard (toggle in the top right)
* **Use test API keys** (starts with `pk_test_` and `sk_test_`)

### Test Cards

Use these test card numbers for testing:

- **Successful payment:** `4242 4242 4242 4242`
  - Any future expiration date (e.g., 12/25)
  - Any 3-digit CVC (e.g., 123)
- **Declined payment:** `4000 0000 0000 0002`
- **Requires authentication:** `4000 0025 0000 3155`
- **Insufficient funds:** `4000 0000 0000 9995`

<Note>
  **Important:** Stripe integration does not work in preview mode. Make sure to **deploy** your app to test the integration.
</Note>

### Test Scenarios

```jsx
// Test different payment scenarios
const testCards = {
  success: '4242424242424242',
  declined: '4000000000000002',
  requiresAuth: '4000002500003155',
  insufficientFunds: '4000000000009995',
};

// Test webhook events
const testWebhook = async () => {
  const response = await fetch('/api/test-webhook', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      eventType: 'payment_intent.succeeded',
      data: { /* test data */ },
    }),
  });

  const result = await response.json();
  return result;
};
```

## Security Best Practices

### Environment Variables

```bash
# .env.local
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
```

### Server-Side Validation

```jsx
// Always validate on the server
const validatePayment = async (paymentIntentId) => {
  const paymentIntent = await stripe.paymentIntents.retrieve(paymentIntentId);
  
  if (paymentIntent.status !== 'succeeded') {
    throw new Error('Payment not completed');
  }
  
  return paymentIntent;
};
```

### Webhook Security

```jsx
// Verify webhook signatures
const verifyWebhook = (payload, signature, secret) => {
  try {
    const event = stripe.webhooks.constructEvent(payload, signature, secret);
    return event;
  } catch (err) {
    throw new Error('Invalid webhook signature');
  }
};
```

## Common Patterns

### Payment Form Component

```jsx
const PaymentForm = ({ amount, onSuccess, onError }) => {
  const stripe = useStripe();
  const elements = useElements();
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (event) => {
    event.preventDefault();

    if (!stripe || !elements) {
      return;
    }

    setLoading(true);

    try {
      const { error, paymentIntent } = await stripe.confirmCardPayment(
        clientSecret,
        {
          payment_method: {
            card: elements.getElement(CardElement),
          },
        }
      );

      if (error) {
        onError(error);
      } else if (paymentIntent.status === 'succeeded') {
        onSuccess(paymentIntent);
      }
    } catch (err) {
      onError(err);
    } finally {
      setLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <CardElement />
      <button disabled={!stripe || loading}>
        {loading ? 'Processing...' : `Pay $${amount}`}
      </button>
    </form>
  );
};
```

### Subscription Status Component

```jsx
const SubscriptionStatus = ({ customerId }) => {
  const [subscription, setSubscription] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchSubscription = async () => {
      try {
        const response = await fetch(`/api/subscription/${customerId}`);
        const data = await response.json();
        setSubscription(data.subscription);
      } catch (error) {
        console.error('Error fetching subscription:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchSubscription();
  }, [customerId]);

  if (loading) return <div>Loading...</div>;

  if (!subscription) return <div>No active subscription</div>;

  return (
    <div>
      <h3>Subscription Status: {subscription.status}</h3>
      <p>Current Period: {subscription.current_period_start} - {subscription.current_period_end}</p>
      <p>Amount: ${subscription.items.data[0].price.unit_amount / 100}</p>
    </div>
  );
};
```

## Debugging & Troubleshooting

<AccordionGroup>
  <Accordion title="Check Console Logs">
    <Steps>
      <Step title="Step 1">
        Open **Developer Tools** (Right-click → Inspect → Console in Chrome).
      </Step>

      <Step title="Step 2">
        Look for errors and review payment event logs.
      </Step>

      <Step title="Step 3">
        Copy error messages and ask superun in chat for debugging assistance.
      </Step>
    </Steps>
  </Accordion>

  <Accordion title="Review superun Cloud Logs">
    <Steps>
      <Step title="Step 1">
        Go to **Build** tab → **Service** section → **superun Cloud**
      </Step>

      <Step title="Step 2">
        Navigate to **Logs** or **Functions** → **Logs**
      </Step>

      <Step title="Step 3">
        Check for webhook errors and payment processing issues.
      </Step>
    </Steps>
  </Accordion>

  <Accordion title="Verify Webhook Events in Stripe">
    <Steps>
      <Step title="Step 1">
        Navigate to **Stripe Dashboard** → **Developers** → **Webhooks**
      </Step>

      <Step title="Step 2">
        Click on your webhook endpoint
      </Step>

      <Step title="Step 3">
        Review the **Events** tab to confirm that Stripe is sending data correctly.
      </Step>
    </Steps>
  </Accordion>

  <Accordion title="Use superun Ask mode">
    <Steps>
      <Step title="Step 1">
        Switch to **Ask** mode and ask superun follow-up questions.
      </Step>

      <Step title="Step 2">
        Describe your issue step by step:
        * "My payment form isn't showing up"
        * "The subscription isn't being created"
        * "Webhooks aren't working"
      </Step>

      <Step title="Step 3">
        Use the **Rubber Duck Method** & explain your issue step by step to clarify the problem.
      </Step>
    </Steps>
  </Accordion>
</AccordionGroup>

### Common Issues

**Q: Payment is failing with "Your card was declined"**

A: This could be due to:
- Using a test card in live mode (or vice versa)
- Insufficient funds (for test cards, use `4242 4242 4242 4242`)
- Card not supported for online payments
- Incorrect card details
- Bank blocking the transaction

**Q: Webhooks are not being received**

A: Check:
- Webhook URL is accessible from the internet
- Webhook endpoint is returning 200 status
- Webhook signing secret is correct
- Events are properly selected in Stripe dashboard
- You're testing in deployed mode (not preview)

**Q: Test payments are not working**

A: Ensure:
- You're using test API keys (`pk_test_` and `sk_test_`)
- Test card numbers are correct (`4242 4242 4242 4242`)
- Amount is in cents (e.g., $10.00 = 1000 cents)
- Your app is **deployed** (Stripe doesn't work in preview mode)
- You're in **Test Mode** in Stripe Dashboard

**Q: Subscription webhooks are not firing**

A: Verify:
- Subscription is created successfully
- Webhook events are selected for subscription events
- Webhook endpoint is handling the events properly
- Webhook secret is correctly stored in superun Cloud

<Card title="Need Help?" icon="help-circle" href="/en/superun/introduction/faq">
  Check our FAQ for common Stripe integration questions and troubleshooting tips.
</Card>
